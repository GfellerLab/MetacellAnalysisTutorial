
**Size distribution**
```{python, warning = FALSE, message = FALSE}
#mc_size = SEACells.plot.plot_SEACell_sizes(ad, bins=20)

#mc_ad.obs = pd.merge(mc_ad.obs, mc_size, left_index=True, right_index=True)
#mc_ad.obs
```

**Purity** of metacells is a proportion of the most abundant cell type within metacell  [ref SuperCell]
```{python}
mc_purity = mc_QC.purity(ad, annotation_label, MC_label = 'membership')
mc_purity.head()
```

**Compactness** of metacells is variance of components within metacells  [ref SEACells]
```{python}
compactness = mc_QC.compactness(ad, 'X_pca', MC_label = 'membership', DO_DC = False, name = 'Compactness_PCA', n_comp=n_comp)['Compactness_PCA']
# add compactness to metadata
mc_ad.obs = mc_ad.obs.join(compactness)
```


**Separation** of metacells is a distance to a closest metacell [ref SEACells]
```{python}
separation = mc_QC.separation(ad, 'X_pca', MC_label = 'membership', DO_DC = False, name = 'Separation_PCA', n_comp=n_comp)['Separation_PCA']
# add separation to metadata
mc_ad.obs = mc_ad.obs.join(separation)
```


**Inner normalized variance (INV)** of metacells is mean-normalized variance of gene expression within metacells [ref MC-2]
```{python, warning = FALSE, message = FALSE, result = FALSE, eval = FALSE}
mc_INV = mc_QC.mc_inner_normalized_var(ad, MC_label = 'membership')

mc_INV_val = mc_INV.quantile(0.95, axis=1, numeric_only=True)
mc_INV_val = pd.DataFrame(mc_INV_val.transpose()).set_axis(['INV'], axis=1, inplace=False)
# add INV to metadata
mc_ad.obs = mc_ad.obs.join(mc_INV_val)
```
